webpackJsonp([4,9],{355:function(t,e,r){function s(t){r(372)}var a=r(1)(r(370),r(373),s,null,null);t.exports=a.exports},364:function(t,e,r){function s(t){r(429)}var a=r(1)(r(400),r(446),s,null,null);t.exports=a.exports},370:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=r(33),a=(r.n(s),r(0));e.default={name:"CommonAddUser",mixins:[s.viewMixin],mounted:function(){this.searchUserBackup=r.i(a.extend)({},this.searchUser),this.searchGroupBackup=r.i(a.extend)({},this.searchGroup)},props:{tabs:{type:String,default:"all"}},data:function(){return{searchUser:{userAccount:"",displayName:""},searchGroup:{groupName:""},userColumns:[{label:"帳號",field:"userAccount",width:"100px",sort:!0},{label:"顯示名稱",field:"displayName",width:"100px",sort:!0}],groupColumns:[{label:"群組名稱",field:"groupName",width:"100px",sort:!0},{label:"備註",field:"description",width:"100px",sort:!0}]}},methods:{open:function(){this.$refs.memberModal.open(),this.$refs.tabs.selectTab("tab-user")},close:function(){this.$refs.memberModal.close()},selectUser:function(){var t=this;this.searchUser=r.i(a.extend)({},this.searchUserBackup),setTimeout(function(){t.$refs.userPager.clean()})},selectGroup:function(){var t=this;this.searchGroup=r.i(a.extend)({},this.searchGroupBackup),setTimeout(function(){t.$refs.groupPager.clean()})},addUserMember:function(){var t=this.$refs.userTable.getChecked();t=t.map(function(t){return{roleType:"U",roleMemberId:t.userId,memberName:t.displayName}}),this.$emit("select",t),this.close()},addGroupMember:function(){var t=this.$refs.groupTable.getChecked();t=t.map(function(t){return{roleType:"G",roleMemberId:t.groupId,memberName:t.groupName}}),this.$emit("select",t),this.close()}},components:{QTabs:a.QTabs,QTab:a.QTab,QTabPane:a.QTabPane,QScrollArea:a.QScrollArea}}},371:function(t,e,r){e=t.exports=r(353)(!1),e.push([t.i,".member .layout-padding{padding:10px}",""])},372:function(t,e,r){var s=r(371);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);r(354)("6b77af24",s,!0,{})},373:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("s-modal",{ref:"memberModal",staticClass:"member",attrs:{title:"加入成員",width:"800px",height:"510px"}},[r("template",{slot:"content"},[r("q-tabs",{ref:"tabs",attrs:{color:"deepblue",align:"center"}},[r("q-tab",{attrs:{default:"",name:"tab-user",label:"使用者",disable:"all"!==t.tabs&&"user"!==t.tabs},on:{select:t.selectUser},slot:"title"}),t._v(" "),r("q-tab",{attrs:{name:"tab-group",label:"群組",disable:"all"!==t.tabs&&"group"!==t.tabs},on:{select:t.selectGroup},slot:"title"}),t._v(" "),r("q-tab-pane",{attrs:{name:"tab-user"}},[r("div",{staticClass:"full-width row md-gutter justify-center",staticStyle:{"padding-bottom":"10px"}},[r("s-input",{staticClass:"col-5",attrs:{label:"帳號"},model:{value:t.searchUser.userAccount,callback:function(e){t.searchUser.userAccount=e},expression:"searchUser.userAccount"}}),t._v(" "),r("s-input",{staticClass:"col-5",attrs:{label:"顯示名稱"},model:{value:t.searchUser.displayName,callback:function(e){t.searchUser.displayName=e},expression:"searchUser.displayName"}})],1),t._v(" "),r("div",{staticClass:"row justify-center xs-gutter",staticStyle:{"padding-bottom":"10px"}},[r("div",[r("s-btn",{attrs:{color:"darkred",big:""},on:{click:function(e){t.$refs.userPager.search(t.searchUser)}}},[t._v("查詢")])],1),t._v(" "),r("div",[r("s-btn",{attrs:{color:"darkred",big:""},on:{click:t.addUserMember}},[t._v("選擇")])],1),t._v(" "),r("div",[r("s-btn",{attrs:{color:"darkred",big:""},on:{click:function(e){t.$refs.memberModal.close()}}},[t._v("取消")])],1)]),t._v(" "),r("s-paginator",{ref:"userPager",staticStyle:{"padding-bottom":"20px"},attrs:{url:"getAuthUserList","page-size":5},scopedSlots:t._u([{key:"default",fn:function(e){return[r("s-datatable",{ref:"userTable",attrs:{source:e.data,offset:e.offset,striped:"",multiple:"",checkboxs:""}},t._l(t.userColumns,function(t,e){return r("s-datatable-column",{key:e,attrs:{column:t},slot:"columns"})}))]}}])})],1),t._v(" "),r("q-tab-pane",{attrs:{name:"tab-group"}},[r("div",{staticClass:"full-width row md-gutter justify-center",staticStyle:{"padding-bottom":"10px"}},[r("s-input",{staticClass:"col-5",attrs:{label:"群組名稱"},model:{value:t.searchGroup.groupName,callback:function(e){t.searchGroup.groupName=e},expression:"searchGroup.groupName"}})],1),t._v(" "),r("div",{staticClass:"row justify-center xs-gutter",staticStyle:{"padding-bottom":"10px"}},[r("div",[r("s-btn",{attrs:{color:"darkred",big:""},on:{click:function(e){t.$refs.groupPager.search(t.searchGroup)}}},[t._v("查詢")])],1),t._v(" "),r("div",[r("s-btn",{attrs:{color:"darkred",big:""},on:{click:t.addGroupMember}},[t._v("選擇")])],1),t._v(" "),r("div",[r("s-btn",{attrs:{color:"darkred",big:""},on:{click:function(e){t.$refs.memberModal.close()}}},[t._v("取消")])],1)]),t._v(" "),r("s-paginator",{ref:"groupPager",staticStyle:{"padding-bottom":"20px"},attrs:{url:"getAuthGroupPageList","page-size":5},scopedSlots:t._u([{key:"default",fn:function(e){return[r("s-datatable",{ref:"groupTable",attrs:{source:e.data,offset:e.offset,striped:"",multiple:"",checkboxs:""}},t._l(t.groupColumns,function(t,e){return r("s-datatable-column",{key:e,attrs:{column:t},slot:"columns"})}))]}}])})],1)],1)],1)],2)},staticRenderFns:[]}},400:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=r(33),a=(r.n(s),r(0)),o=r(355),i=r.n(o);e.default={name:"GroupManage",mixins:[s.viewMixin],mounted:function(){this.groupBackup=r.i(a.extend)({},this.group),this.findGroup()},data:function(){return{group:{groupId:null,groupName:"",description:""},groupBackup:{},groupTemp:{},filterItem:"",groupName:"",userList:[],groupList:[],columns:[{label:"群組成員",field:"userAccount",width:"100px",sort:!0},{label:"顯示名稱",field:"displayName",width:"100px",sort:!0},{label:"Email",field:"email",width:"150px",sort:!0}]}},computed:{groupFilter:function(){var t=this;return this.groupList.filter(function(e){return e.groupName.indexOf(t.filterItem)>-1})}},methods:{findGroup:function(){var t=this;this.get("getAuthGroupList",{},function(e){t.groupList=e})},findUser:function(){var t=this;this.get("getAuthGroupUserList",this.group,function(e){t.userList=e})},selectGroup:function(t){t.groupId!==this.group.groupId?(this.group=t,this.findUser()):(this.group=r.i(a.extend)({},this.groupBackup),this.userList=[])},addGroup:function(){this.groupTemp=r.i(a.extend)({},this.groupBackup),this.$refs.groupModal.open()},editGroup:function(){this.groupTemp=r.i(a.extend)({},this.group),this.$refs.groupModal.open()},saveGroup:function(){var t=this;if(!this.groupTemp.groupName)return void this.showError("請輸入群組名稱");this.put("saveAuthGroup",this.groupTemp,function(){t.$refs.groupModal.close(),t.showSuccess("群組儲存成功",3e3),t.findGroup()})},delGroup:function(){var t=this;this.confirm("刪除群組","是否確定刪除該群組？",function(){t.delete("deleteAuthGroup",{groupId:t.group.groupId},function(e){e?(t.showSuccess("群組刪除成功",3e3),t.group=r.i(a.extend)({},t.groupBackup),t.findGroup()):t.showError("群組尚有角色關聯無法刪除")})})},addUser:function(t){var e=this;t.length>0&&(t=t.map(function(t){return{groupId:e.group.groupId,userId:t.roleMemberId}}),t=t.filter(function(t){return 0===e.userList.filter(function(e){return e.userId===t.userId}).length}),t.length>0&&(this.userList=this.userList.concat(t),this.put("saveAuthGroupDetails",t,function(){e.showSuccess("群組成員加入成功",3e3),e.findUser()})))},removeUser:function(){var t=this,e=this.$refs.userTable.getChecked();e.length>0&&(console.log(e),this.confirm("移除成員","是否確定移除群組成員？",function(){t.post("deleteAuthGroupDetails",e,function(){t.showSuccess("群組成員移除成功",3e3),t.findUser()})}))}},components:{CommonAddUser:i.a,QCard:a.QCard,QCardTitle:a.QCardTitle,QCardMain:a.QCardMain,QCardActions:a.QCardActions,QCardSeparator:a.QCardSeparator,QList:a.QList,QItem:a.QItem,QItemMain:a.QItemMain,QScrollArea:a.QScrollArea}}},419:function(t,e,r){e=t.exports=r(353)(!1),e.push([t.i,".group-manage .q-card-actions{padding-left:0;padding-right:0}",""])},429:function(t,e,r){var s=r(419);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);r(354)("58340162",s,!0,{})},446:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"group-manage row",staticStyle:{padding:"0 10px"}},[r("q-card",{staticClass:"col-4"},[r("div",{staticClass:"card-header row items-center"},[r("q-card-title",{attrs:{"data-background-color":"darkblue"}},[r("span",{staticStyle:{color:"white"}},[t._v("群組管理")])]),t._v(" "),r("span",{staticClass:"s-card-title col-auto"})],1),t._v(" "),r("s-input",{staticStyle:{padding:"5px 10px"},attrs:{label:"過濾條件"},model:{value:t.filterItem,callback:function(e){t.filterItem=e},expression:"filterItem"}}),t._v(" "),r("q-card-actions",{attrs:{align:"center"}},[r("div",{staticClass:"s-card-actions",attrs:{"data-background-color":"darkblue"}}),t._v(" "),r("s-btn",{staticStyle:{padding:"0 8px"},attrs:{color:"darkred",big:""},on:{click:t.addGroup}},[t._v("新增群組")]),t._v(" "),r("s-btn",{staticStyle:{padding:"0 8px"},attrs:{color:"darkred",big:"",disable:!t.group.groupName},on:{click:t.editGroup}},[t._v("編輯群組")]),t._v(" "),r("s-btn",{staticStyle:{padding:"0 8px"},attrs:{color:"darkred",big:"",disable:!t.group.groupName},on:{click:t.delGroup}},[t._v("刪除群組")])],1),t._v(" "),r("q-card-separator"),t._v(" "),r("q-card-main",{staticStyle:{"padding-top":"10px"}},[r("q-scroll-area",{staticStyle:{height:"calc(100vh - 300px)"}},[r("q-list",{attrs:{hightlight:"",link:"",separator:"","no-border":"",striped:""}},t._l(t.groupFilter,function(e,s){return r("q-item",{key:s,on:{click:function(r){t.selectGroup(e,r)}}},[r("q-item-main",{style:{color:t.group.groupName===e.groupName?"red":"black"},attrs:{label:e.groupName}})],1)}))],1)],1)],1),t._v(" "),r("s-card",{staticClass:"col-8",staticStyle:{"padding-left":"10px"},attrs:{color:"darkblue",title:"群組成員管理"}},[r("div",{slot:"content"},[r("div",{staticClass:"row items-center",staticStyle:{"padding-bottom":"10px"}},[r("span",{staticClass:"col-auto"},[t._v("選擇群組："+t._s(t.group.groupName))]),t._v(" "),r("div",{staticClass:"col row justify-end xs-gutter"},[r("div",{staticClass:"col-auto"},[r("s-btn",{attrs:{color:"darkred"},on:{click:function(e){t.$refs.userModal.open()}}},[t._v("加入成員")])],1),t._v(" "),r("div",{staticClass:"col-auto"},[r("s-btn",{attrs:{color:"darkred"},on:{click:function(e){t.removeUser()}}},[t._v("移除成員")])],1)])]),t._v(" "),r("q-scroll-area",{staticStyle:{height:"calc(100vh - 235px)"}},[r("s-datatable",{ref:"userTable",attrs:{source:t.userList,striped:"",multiple:"",checkboxs:""}},t._l(t.columns,function(t,e){return r("s-datatable-column",{key:e,attrs:{column:t},slot:"columns"})}))],1)],1)]),t._v(" "),r("s-modal",{ref:"groupModal",attrs:{title:"群組維護",width:"400px",height:"290px"}},[r("s-input",{attrs:{label:"群組名稱"},slot:"content",model:{value:t.groupTemp.groupName,callback:function(e){t.groupTemp.groupName=e},expression:"groupTemp.groupName"}}),t._v(" "),r("s-input",{attrs:{label:"群組說明",type:"textarea","min-rows":5,"max-height":100},slot:"content",model:{value:t.groupTemp.description,callback:function(e){t.groupTemp.description=e},expression:"groupTemp.description"}}),t._v(" "),r("s-btn",{attrs:{color:"darkred",big:""},on:{click:t.saveGroup},slot:"action"},[t._v("儲存")]),t._v(" "),r("s-btn",{attrs:{color:"darkred",big:""},on:{click:function(e){t.$refs.groupModal.close()}},slot:"action"},[t._v("取消")])],1),t._v(" "),r("common-add-user",{ref:"userModal",attrs:{tabs:"user"},on:{select:t.addUser}})],1)},staticRenderFns:[]}}});